@if (!loading && isAuthenticated()) {
  <nav aria-label="breadcrumb">
    <div class="breadcrumbs">
      <a class="breadcrumb-link" routerLink="/list">Job List</a>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-current">{{ jobData?.name || 'Job Detail' }}</span>
    </div>
  </nav>
}

<div class="job-detail-container">
  @if (loading) {
    <div class="loading-container">
      <mat-spinner diameter="50" color="accent"></mat-spinner>
      <span>Loading...</span>
    </div>
  }

  @if (!loading) {
    <div>
      @if (isAuthenticated()) {
        <mat-card class="job-card">
          <mat-card-content>
            <app-job-form 
              [initialData]="jobData"
              [showIcons]="false"
              (formSubmit)="onFormSubmit($event)"
              (linkOpen)="onLinkOpen($event)">
            </app-job-form>
          </mat-card-content>
          <mat-divider></mat-divider>
          <mat-card-actions>
            <div class="action-buttons">
              <button mat-button type="button" (click)="setTodayRefusal()" color="accent">
                <mat-icon>event</mat-icon> Today's Refusal
              </button>
              <span class="spacer"></span> 
              <button mat-stroked-button type="button" color="warn" (click)="confirmDelete()">
                <mat-icon>delete</mat-icon> Delete
              </button>
              <span class="button-gap"></span>
              <button mat-raised-button color="primary" (click)="submitForm()" [disabled]="!isFormValid">
                <mat-icon>save</mat-icon> Save
              </button>
            </div>
          </mat-card-actions>
        </mat-card>
      } @else {
        <mat-card class="not-logged-card">
          <mat-card-content>
            <mat-icon class="warning-icon">lock</mat-icon>
            <p>You must be logged in to view this page.</p>
          </mat-card-content>
        </mat-card>
      }
    </div>
  }
</div>