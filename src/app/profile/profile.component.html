<div class="profile-card">
  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" *ngIf="profileForm">
    <div class="form-group">
      <label for="username">Username</label>
      <input id="username" type="text" formControlName="username" />
      <div class="error" *ngIf="profileForm.get('username')?.touched && profileForm.get('username')?.invalid">
        Username is required
      </div>
    </div>

    <div class="form-group">
      <label for="password">Password</label>
      <div class="input-group">
        <input id="password" [type]="showPassword ? 'text' : 'password'" formControlName="password" />
        <button type="button" (click)="togglePassword()">{{ showPassword ? 'Hide' : 'Show' }}</button>
      </div>
      <div class="error" *ngIf="profileForm.get('password')?.touched && profileForm.get('password')?.invalid">
        <div *ngIf="profileForm.get('password')?.errors?.['required']">Password is required</div>
        <div *ngIf="profileForm.get('password')?.errors?.['minlength']">Password must be at least 8 characters</div>
        <div *ngIf="profileForm.get('password')?.errors?.['maxlength']">Password must not exceed 100 characters</div>
        <div *ngIf="profileForm.get('password')?.errors?.['pattern']">Password must have lowercase, uppercase, and a digit</div>
      </div>
    </div>

    <div class="form-group">
      <label for="confirmPassword">Confirm Password</label>
      <div class="input-group">
        <input id="confirmPassword" [type]="showConfirmPassword ? 'text' : 'password'" formControlName="confirmPassword" />
        <button type="button" (click)="toggleConfirmPassword()">{{ showConfirmPassword ? 'Hide' : 'Show' }}</button>
      </div>
      <div class="error" *ngIf="profileForm.hasError('mismatch') && profileForm.get('confirmPassword')?.touched">
        Passwords must match
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="delete" (click)="openDeleteDialog()">Delete Account</button>
      <button type="submit" [disabled]="isSubmitting">Submit</button>
    </div>
  </form>

  <!-- Delete confirmation dialog -->
  <div class="dialog-overlay" *ngIf="deleteDialogOpen">
    <div class="dialog">
      <h2>Delete Account</h2>
      <p>Are you sure? This action cannot be undone.</p>
      <div class="dialog-actions">
        <button (click)="closeDeleteDialog()">Cancel</button>
        <button class="delete" (click)="handleDelete()">Delete</button>
      </div>
    </div>
  </div>
</div>
